#!/usr/bin/env bash

set -eu -o pipefail

# shellcheck source=../lib/utils.sh
source "$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)/../lib/utils.sh"

if [ -z "$ASDF_DOWNLOAD_PATH" ]
then
  # Old asdf version, must download first
  get_download_urls "$ASDF_INSTALL_VERSION" "$os_arch" \
  | xargs -P1 -I{} sh -c "curl -sSfL {} | tar -jx -C $ASDF_INSTALL_PATH --strip-components=1"
else
  # New asdf version, download is already done
  cp -R "$ASDF_DOWNLOAD_PATH/" "$ASDF_INSTALL_PATH"
fi
